\documentclass[review]{elsarticle}

%% \usepackage{lineno,hyperref}
\usepackage{hyperref}
%% \modulolinenumbers[5]
\usepackage{graphicx}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{enumitem}

\journal{NeuroImage}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frontmatter}

\title{The Brainomics/Localizer database}

\author[Neurospin]{Dimitri Papadopoulos Orfanos\corref{mycorrespondingauthor}}
\ead{dimitri.papadopoulos@cea.fr}
\cortext[mycorrespondingauthor]{Corresponding author}
\author[Logilab]{Vincent Michel}
\author[Parietal,Neurospin]{Yannick Schwartz}
\author[U992,Neurospin,ParisSud]{Philippe Pinel}
\author[U992,Neurospin,ParisSud]{Antonio Moreno}
\author[Neurospin]{Denis Le Bihan}
\author[Neurospin]{Vincent Frouin}

\address[Neurospin]{CEA, DSV/I2BM, NeuroSpin, 91191 Gif-sur-Yvette, France}
\address[U992]{INSERM, U992, Cognitive Neuroimaging Unit, 91191 Gif-sur-Yvette, France}
\address[Parietal]{Parietal team, Inria Saclay \^Ile-de-France, 91120 Palaiseau, France}
\address[ParisSud]{Univ. Paris-Sud, Cognitive Neuroimaging Unit, 91191 Gif-sur-Yvette, France}
\address[Logilab]{Logilab, 104 boulevard Auguste Blanqui, 75013 Paris, France}

\begin{abstract}
The Brainomics/Localizer database exposes part of the data collected by the in house Localizer project, which planned to acquire four types of data from volunteer research subjects: anatomical MRI scans, functional MRI data, behavioural and demographic data, and DNA sampling. Over the years, this local project has been collecting such data from hundreds of subjects. For the Brainomics/Localizer public database, we selected 94 of these subjects for their complete datasets, including all four types of data.

To publish this set of heterogeneous data, we use dedicated software based on the open-source CubicWeb semantic web framework. Through genericity in the data model and flexibility in the display of data (web pages, JSON, XML), CubicWeb helps us expose these complex datasets in original and efficient ways.
\end{abstract}

\end{frontmatter}


\section{Introduction}

\paragraph{The Localizer project} The Localizer project initially planned to investigate inter-subject variability \cite{Pinel2007}. We have been collecting data from volunteer research subjects taking part in different studies carried in our lab. The investigators of these studies agreed to provide behavioural and demographic data, anatomical MRI scans and DNA sampling. They also agreed to acquire a short fMRI sequence, approximatively 5 minutes long, after their functional imaging session, specifically for the Localizer project. We were thus able to collect data from a considerably larger number of volunteer research subjects than a single study could afford.

\paragraph{The Brainomics project} Meanwhile the Brainomics project has been working on genetic neuroimaging. We felt the need for a database that could index and expose heterogeneous data including MRI images, genetic data or behavioural data. We based our software developments on the CubicWeb framework and wrote specific modules to describe and visualize neuroimaging and genetic data. We decided to build a Brainomics/Localizer demonstrator based on the Localizer dataset. The resulting database is now publicly available \footnote{http://brainomics.cea.fr/localizer} as well as the source code \cite{Localizer}.

\paragraph{Opening the data} We also viewed the Brainomics/Localizer demonstrator as an opportunity to study the feasibility of opening up medical research data. Brainomics/Localizer is one of the rare public databases of individual health information in France.


\section{Material and methods}

\subsection{De-identification of the database}

The ethics committee had initially approved the Localizer study. Starting the Brainomics/Localizer database effort, we addressed with the ethics committee the publication of Localizer data as support material for one of the published paper \cite{Pinel2012}, in order to facilitate replication of the results. We came up with the following procedure to de-identify data.

Before publishing the data, we anonymize the data in an irreversible way by re-encoding all subject identifiers and discarding the conversion table. Data is stored on an online server and made available to the broader scientific community as a web service. Users will be able to access the data with a web browser.

\paragraph{Imaging data} In addition to re-encoding subject identifiers, anatomical MRI images are defaced, using the \textit{mri\_deface} tool of Freesurfer \cite{Fischl2012}.

\paragraph{Genetic data} The very nature of genotyping data identifies a subject, by mere comparison to other genotyping data collected elsewhere. As a result genetic data cannot be downloaded from the server. Users of the server can nevertheless start calculations on the server itself from a user interface, using the genetic data of all subjects as a parameter. The results of such calculations are images like those presented in Fig.~1 of \cite{Pinel2012}. These actions should be crafted carefully to forbid retrieval of individual genotypic data.

\paragraph{Demographic and behavioural data} Only data related to the publication \cite{Pinel2007} are uploaded to the server. Such data do not present a risk of identifying the subject.


\subsection{Software infrastructure}

\subsubsection{The Brainomics genetic neuroimaging database}

The need to manage data growing in volume and complexity have led the neuroimaging field to rely increasingly on database infrastructures. These databases typically provide support for multiple data types \textit{e.g.}, brain images, behavioural and demographic data, neuropsychological scores, and genetic data. Popular solutions for storing such data at a large scale are COINS \cite{COINS2011} and XNAT \cite{XNAT2007}.

We chose CubicWeb, which is an alternative open-source framework. We customized it for the requirements of neuroimaging. The resulting Brainomics genetic neuroimaging database permits a deep integration of imaging and genetic data \cite{HBM2013}. We use this system internally to assemble joint data types queries. Currently the publicly available database excludes genetic data, for ethical reasons.


\subsubsection{The CubicWeb framework}
\label{sec:cubicweb}

The CubicWeb framework \cite{CubicWeb} follows the semantic web approach: data are exposed using ontologies for easier sharing, access, and processing, and each item is identified by a unique ID (called URI). CubicWeb is built upon well established core technologies such as SQL, Python and web standards (HTML5 and JavaScript). It has been successfully used in large semantic web and knowledge management projects \cite{Simon2013}.

One major part of a CubicWeb application is the data model, defined by Python classes, from which CubicWeb generates the underlying SQL tables. It is thus possible to query the data via the RQL language which predates but is similar to W3C's SPARQL. This language provides an abstraction over the underlying database, queries being expressed in terms of business logic rather than low-level SQL schema. For example, \emph{Query all the scans of male subjects} can be expressed in RQL as \emph{Any X WHERE S is Subject, S gender "male", X is Scan, X concerns S}.

Moreover, CubicWeb implements a mechanism to expose information in several ways called ``views''. Being defined in Python, the views are applied on query results, and can produce any kind of output, such as web pages, but also binary data or even trigger external processing. The separation of queries and views holds major advantages:
\begin{enumerate}[label=\roman*)]
\item The same data selection may have several representations, e.g. the subject \emph{S65}, defined by a single query (\emph{Any X WHERE X is Subject, X identifier "S65"}) can be viewed as HTML \footnote{\url{http://brainomics.cea.fr/localizer/dataset?rql=Any\%20X\%20WHERE\%20X\%20is\%20Subject,\%20X\%20identifier\%20\%22S65\%22}}, CSV \footnote{\url{http://brainomics.cea.fr/localizer/dataset?rql=Any\%20X\%20WHERE\%20X\%20is\%20Subject,\%20X\%20identifier\%20\%22S65\%22&vid=csvexport}} or XML \footnote{\url{http://brainomics.cea.fr/localizer/dataset?rql=Any\%20X\%20WHERE\%20X\%20is\%20Subject,\%20X\%20identifier\%20\%22S65\%22&vid=xcede}}. Each couple \emph{(query, view)} is identified by a unique URL.
\item Data can be exported in several other formats (e.g. XCEDE or MAGE-ML) without modifying the underlying data storage. The data model can be performance-oriented, adding a new ontology for sharing the data being simply a new view to define.
\end{enumerate}
Finally, CubicWeb has a security system, coupled to the data model definition, that grants fine-grained data access rights. CubicWeb may run as a standalone application or be smoothly integrated in a platform combining Apache and SFTP with LDAP. It is distributed under the LGPL license.

In the Brainomics project, we leveraged CubicWeb and defined domain specific modules, denoted ``cubes'' in the terminology of CubicWeb, that easily connect each another.


\subsubsection{Development of domain specific modules}

We developed one cube per data type. Each cube is connected to the others - if needed - in the final database schema. The \textit{medicalexp} cube contains the definition of general entities like Subject, Center, Assessment; the \textit{neuroimaging} (resp. \textit{genetics}) cube defines entities and relations like Scan, Scanner (resp. SnpVariant, Platform, GenotypeMeasurement). Each cube implements the corresponding views (navigation, download), triggers and access rights. Connected together, those cubes and others are used to build the complete Brainomics/Localizer database. Like the CubicWeb framework, these cubes are distributed under the LGPL license and the source code is available from the CubicWeb web site \cite{CubicWeb} and GitHub \cite{Localizer}.


\begin{figure}[ht!]
    \includegraphics[width=\textwidth]{ui1}
    \caption{Screenshot of Brainomics' web interface, showing the downloading and filtering (facets) menus on the left, and the summary representation of the images in the database.}
    \label{fig:ui}
\end{figure}



\section{Description of the repository}

\subsection{Purpose of the database}

Our database was designed to publish data from the Localizer project \cite{Pinel2007} and more specifically the subset of 94 subjects examined in \cite{Pinel2012}, and make it available to the broader scientific community. Our intent was to set up a demonstrator for the software we have developed in the context of our Brainomics project.

We provide a static set of data. In the short term we have no plans for adding data from other subjects of the Localizer study.


\subsection{Available data}

Of the hundreds of subjects acquired in house by the Localizer project, we selected a subset of 94 subjects for their complete datasets \cite{Pinel2012} including all four aforementioned types of data. Retained subjects were mostly young Caucasian highly educated, mostly normal readers, 49 women and 45 men. The exact age of 4 subjects remains unknown, the rest were from 18 through 49 years old -- mean age was 24.7 years old. All subjects were right-handed and native French speakers.

Demographic data displayed by the database include gender, age at the time of inclusion, handedness, native language and a family identifier which helps identifying siblings.

Behavioural data aimed to create a rough cognitive profile of each subject. Each profile contains scores for 126 questions covering education, developmental disorders, reading difficulties, basic numerical knowledge, arithmetical skills, visuo-spatial abilities, and visuo-motor abilities.

MRI data were acquired on the two 3~T MRI scanners used successively over time for routine acquisitions. They were then processed using SPM5. Raw and processed MRI data are available in the NIfTI format. Both raw and normalized T1-weighted anatomical MRI scans are provided for each subject. Functional MRI data includes raw EPI scans, preprocessed fMRI scans and statistical parametric maps. The fMRI experimental design as well as data processing are described in more detail in the initial Localizer article \cite{Pinel2007}. Let us only cite the challenging constraints taken into account when designing the sequence:
\begin{itemize}
\item the sequence had to be short, so as to disrupt as little as possible the main protocol. We choose 5 minutes for performing 100 trials.
\item we aimed to obtain for each subject a description of different levels of functional architecture, from sensorimotor areas (perception and action) to more associative areas involved in reading, language processing and calculation.
\item we aimed to capture in 5 minutes most of the individual networks related to each task.
\item individual networks described in 5~min had to be reproducible over sessions and time.
\end{itemize}

\underline{BEGIN TODO}

\underline{FILE FORMAT!}

Images are made available as NIfTI files. They can be downloaded in ZIP files from the Brainomics/Localizer server. Other data can be viewed as tabular form in the Web interface and exported to a variety of formats such as CSV, as described in paragraph~\ref{sec:cubicweb}.

\underline{doi's or uri's}

\underline{END TODO}


\subsection{Quality control and review of the data}

All anatomical MRI scans have been examined by radiologists for possible health issues. We cross-checked demographic data available from different sources, and manually reviewed behavioural data for each subject. Finally fMRI processed images were visually checked. A ``summary sheet'' (Fig.~\ref{fig:summary}) was generated for every subject to evaluate the quality of the fMRI acquisition. All 94 subjects were considered good enough.

\begin{figure}[ht!]
    \centering
    \includegraphics[scale=0.4]{summary}
    \caption{This summary sheet generated for each of the subjects helps assess the quality of the fMRI acquisition. The summary sheet shows, in the lower half, the translation and rotation movement curves for the subject, with maximal amplitudes printed beside the graphics. It also shows sagittal views of the normalized anatomy and of an unthresholded contrast in order to check that normalization has been performed correctly. In the upper half of the sheet, six selected contrasts and a conjunction of two contrasts are shown on ``glass brain'' figures. The goal of these images is to verify that the main activations are in the expected regions of the brain. This is done visually but also a quick test is performed: for each contrast, regions of interest and adapted thresholds are defined and, if the activation for the subject is good enough, the contrast is considered correct. Therefore, if the six contrasts are good, the ``final score'' that appears in the middle part of the sheet will be equal to 6. If only two of them are correct, the score will be 2/6. Other processing parameters are also shown in the middle and top of this summary sheet.}
    \label{fig:summary}
\end{figure}


\subsection{How to access the data}

Data are available to everyone, without prior authentication, at \url{http://brainomics.cea.fr/localizer}. A registration process had initially been set up but later removed because it deterred users from trying to access the data. The same mechanism is used for imaging and phenotypic data. Imaging data can be selected in the user interface, they are then packed into a ZIP file and can be downloaded. Phenotypic data are directly available in the user interface and can be downloaded as a CSV file.

Data are made available under the Creative Commons 3.0 licence (CC BY 3.0). We ask our work is acknowledged in publications that use data made available in the Brainomics/Localizer database.


\subsection{Future developments}

Since this specific database was designed to serve data from the Localizer project, we do not plan on hosting new data. We do operate other databases running the same software stack though, within projects such as IMAGEN \cite{Imagen2010} or EU-AIMS \cite{Aims2014} which keep collecting and exposing new data.

The long term plans for this resource is to keep it alive as a public example instance of the {Brainomics} software. The server application software is currently frozen, however we do hope to upgrade the software to more recent versions in the near future and fix any remaining glitches in data presentation.


\section{Conclusion}

\section{Acknowledgements}

This work was supported by ANR-10-BINF-04.

We thank Stanislas Dehaene for his participation to the creation and for the sharing of the Localizer database. 

We thank Virgile Fritsch and the Parietal team for writing the code that loads the Localizer dataset in NiLearn.


\section*{References}

\bibliography{brainomics_localizer}

\end{document}
